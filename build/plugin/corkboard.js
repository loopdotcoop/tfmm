// Generated by CoffeeScript 1.9.2

/*! Tfmm 0.0.3 //// MIT Licence //// http://tfmm.loop.coop/
 *  plugin/corkboard.litcoffee
 */

(function() {
  var $player, $ref, art, fn, fn1, i, j, k, len, len1, len2, ref, ref1;

  $('style').innerHTML += "\n/* injected by Apage’s Corkboard plugin */\nbody {\n  overflow: hidden;\n  text-align: center;\n}\narticle {\n  display: none;\n}\narticle.active,\n#apage_readme {\n  display: block;\n}\n\n#apage_readme h1 {\n  display: none;\n}\n#apage_readme li {\n  list-style-type: none;\n}\n#apage_readme h4 a,\n#apage_readme li a {\n  position: absolute;\n  z-index: 99;\n  border: 4px solid blue; \n}\n#apage_readme h4 a {\n  top:    0;\n  right:  0;\n}\n#apage_readme li a[href=\"http://loop.coop\"] {\n  top:    0;\n  left:   0;\n}\n#apage_readme li a[href*=\"www.facebook.com\"] {\n  bottom: 0;\n  left:   0;\n}\n#apage_readme li a[href*=\"twitter.com\"] {\n  bottom: 0;\n  left:   100px;\n}\n#apage_readme li a[href$=\"documentation\"] {\n  bottom: 0;\n  right:  0;\n}\n\narticle[data-apage-dname=\"_doc_\"] {\n  position: absolute;\n  z-index: 99;\n  top:    15%;\n  right:  20%;\n  bottom: 20%;\n  left:   20%;\n  overflow-y: scroll;\n  text-align: left;\n  border: 4px solid cyan; \n}\n\narticle[data-apage-dname=\"_play_\"] {\n  position: relative;\n  z-index: 55;\n  display: inline-block;\n  vertical-align: top;\n  width: 4em;\n  height: 4em;\n  cursor: pointer;\n  border: 4px solid magenta;\n  transition: all .5s;\n}\narticle[data-apage-dname=\"_play_\"].active {\n  border: 4px solid orange;\n  width: 40em;\n  height: 40em;\n}\narticle[data-apage-dname=\"_play_\"] canvas {\n  background-color: #ccc;\n  width: 100%;\n  height: 100%;\n}";

  $ref = document.createElement('article');

  $ref.setAttribute('class', 'apage');

  $ref.setAttribute('id', 'apage_undefined');

  $ref.innerHTML = "<!-- injected by Apage’s Pagination plugin -->\n<h1>Article Not Found</h1>";

  d.body.appendChild($ref);

  arts.push({
    id: 'undefined',
    opath: '',
    dname: '',
    order: 0,
    front: [],
    title: 'Article Not Found',
    $ref: $ref
  });

  for (i = 0, len = arts.length; i < len; i++) {
    art = arts[i];
    arts[art.id] = art;
  }

  arts['_'] = arts[0] || arts.undefined;

  ref = $$('article[data-apage-dname="_play_"]');
  fn = function($player) {
    return $player.innerHTML = '<canvas></canvas>';
  };
  for (j = 0, len1 = ref.length; j < len1; j++) {
    $player = ref[j];
    fn($player);
  }

  window.addEventListener('click', function() {
    return window.location.hash = '/';
  });

  ref1 = $$('article[data-apage-dname="_play_"]');
  fn1 = function($player) {
    return $player.addEventListener('click', function(event) {
      if (-1 === this.className.indexOf('active')) {
        window.location.hash = this.id.substr(5).replace(/_/g, '/');
      } else {
        console.log(arts[this.id].front);
      }
      return event.stopPropagation();
    });
  };
  for (k = 0, len2 = ref1.length; k < len2; k++) {
    $player = ref1[k];
    fn1($player);
  }

  resolvers.push(function(query) {
    if (!query) {
      return {
        art: arts[0]
      };
    }
    if (arts[query]) {
      return {
        art: arts[query]
      };
    }
    query = 'apage' + query;
    if (arts[query]) {
      return {
        art: arts[query]
      };
    }
    return {
      backstop: arts.undefined
    };
  });

  updaters.push(function(current) {
    var l, len3;
    for (l = 0, len3 = arts.length; l < len3; l++) {
      art = arts[l];
      art.$ref.className = art.$ref.className.replace(/\s*active|\s*$/g, '');
    }
    current.$ref.className += ' active';
    return d.title = current.title;
  });

}).call(this);
